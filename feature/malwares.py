import requests 
import json

class Malwares:
    def __init__(self):
        pass
    
    def start(self, url: str) -> dict:
        params = {'api_key': self.getApiKey(), 'url': url}
        headers = {'Content-Type' : 'application/x-www-form-urlencoded'}
        response = requests.post('https://public.api.malwares.com/v3/url/info', data=params, headers=headers)
        
        # if json_response['smishing'] == 1:
        #     print("DANGER")
        # else:
        #     print("SAFE")

        return response.json()

    def getApiKey(self) -> str:
        f = open("./config/api.json")
        api_key = json.load(f)
        
        return api_key["malwares_api"]